{%- style -%}
  .video-break {
    position: relative;
    width: 100%;
    height: {{ section.settings.height }}vh;
    overflow: hidden;
    background-color: #0a0a0a;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .video-break__video {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .video-break__overlay {
    position: absolute;
    inset: 0;
    background-color: rgba(0, 0, 0, {{ section.settings.overlay_opacity | divided_by: 100.0 }});
    z-index: 1;
    pointer-events: none;
  }

  .video-break__content {
    position: relative;
    z-index: 2;
    text-align: center;
    padding: 2rem;
    max-width: 720px;
  }

  .video-break__heading {
    font-size: clamp(2.6rem, 5vw, 5.4rem);
    font-weight: 300;
    line-height: 1.1;
    letter-spacing: -0.02em;
    color: #fff;
    margin: 0 0 2rem;
    text-transform: uppercase;
  }

  .video-break__heading em {
    font-style: italic;
    font-weight: 400;
  }

  .video-break__btn {
    display: inline-block;
    padding: 1.6rem 4rem;
    font-size: 1.1rem;
    font-weight: 600;
    letter-spacing: 0.2em;
    text-transform: uppercase;
    text-decoration: none;
    color: #0a0a0a;
    background-color: #fff;
    border: none;
    transition: background-color 0.3s ease, color 0.3s ease, letter-spacing 0.4s ease;
  }

  .video-break__btn:hover {
    background-color: rgba(255, 255, 255, 0.85);
    letter-spacing: 0.28em;
  }

  @media screen and (max-width: 749px) {
    .video-break__heading {
      font-size: clamp(2.2rem, 8vw, 3.4rem);
    }

    .video-break__btn {
      padding: 1.4rem 3rem;
      font-size: 1rem;
    }
  }
{%- endstyle -%}

<div class="video-break color-{{ section.settings.color_scheme }}">
  {%- if section.settings.video_url != blank -%}
    {%- liquid
      assign video_src = section.settings.video_url
      unless video_src contains '//' or video_src contains 'http'
        assign video_src = video_src | asset_url
      endunless
    -%}
    <video
      class="video-break__video"
      autoplay
      muted
      loop
      playsinline
      preload="auto"
      aria-hidden="true"
      {%- if section.settings.image != blank -%}
        poster="{{ section.settings.image | image_url: width: 1920 }}"
      {%- endif -%}
    >
      <source src="{{ video_src }}" type="video/mp4">
    </video>
  {%- endif -%}

  <div class="video-break__overlay"></div>

  <div class="video-break__content">
    {%- if section.settings.heading != blank -%}
      <h2 class="video-break__heading">{{ section.settings.heading }}</h2>
    {%- endif -%}
    {%- if section.settings.button_label != blank -%}
      {%- liquid
        assign link_url = section.settings.button_link
        assign is_external = false
        if link_url contains '://'
          assign is_external = true
        endif
      -%}
      <a
        href="{{ link_url }}"
        class="video-break__btn"
        {% if is_external %}target="_blank" rel="noopener noreferrer"{% endif %}
      >
        {{ section.settings.button_label | escape }}
      </a>
    {%- endif -%}
  </div>
</div>

{% javascript %}
  document.querySelectorAll('.video-break__video').forEach(function(video) {
    video.play().catch(function() {});
  });
{% endjavascript %}

{% schema %}
{
  "name": "t:sections.video_break.name",
  "settings": [
    {
      "type": "text",
      "id": "video_url",
      "label": "t:sections.video_break.settings.video_url.label",
      "info": "t:sections.video_break.settings.video_url.info"
    },
    {
      "type": "image_picker",
      "id": "image",
      "label": "t:sections.video_break.settings.image.label",
      "info": "t:sections.video_break.settings.image.info"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "t:sections.video_break.settings.heading.label",
      "default": "Il morso non si dimentica"
    },
    {
      "type": "text",
      "id": "button_label",
      "label": "t:sections.video_break.settings.button_label.label",
      "default": "Esplora la collezione"
    },
    {
      "type": "url",
      "id": "button_link",
      "label": "t:sections.video_break.settings.button_link.label"
    },
    {
      "type": "range",
      "id": "height",
      "label": "t:sections.video_break.settings.height.label",
      "min": 30,
      "max": 100,
      "step": 5,
      "unit": "vh",
      "default": 60
    },
    {
      "type": "range",
      "id": "overlay_opacity",
      "label": "t:sections.video_break.settings.overlay_opacity.label",
      "min": 0,
      "max": 80,
      "step": 5,
      "unit": "%",
      "default": 40
    },
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "t:sections.all.colors.label",
      "default": "scheme-1"
    }
  ],
  "presets": [
    {
      "name": "t:sections.video_break.name"
    }
  ]
}
{% endschema %}
